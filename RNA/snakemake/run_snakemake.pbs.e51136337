-------------------------------------------------------------------------------
There are messages associated with the following module(s):
-------------------------------------------------------------------------------

GCC/11.3.0:
   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   + ___________________________________ + + / This module will soon no
   longer \ + + \ be available on this cluster! / + +
   ----------------------------------- + + \ ^__^ + + \ (xx)\_______ + +
   (__)\ )\/\ + + U ||----w | + + || || + + + + Only modules installed with
   a recent toolchain will still be available + + when this cluster has been
   migrated to the RHEL 9 operating system. + + Recent toolchains include
   GCC(core)/12.3.0, gompi/2023a, foss/2023a, + + gfbf/2023a, iimpi/2023a,
   intel/2023a, and newer versions. + + + + You should update your workflow
   or job script to use more recent software installations, + + or accept
   that the modules you currently rely on will soon no longer be available.
   + + + + To request a more recent version of the software you are using, +
   + please submit a software installation request via: + +
   https://www.ugent.be/hpc/en/support/software-installation-request + + + +
   The HPC-UGent Tier-2 clusters running RHEL 8 will be migrated to RHEL 9.
   + + For more information, see https://docs.hpc.ugent.be/rhel9/ . + + + +
   If you have any questions, please contact hpc@ugent.be . + + + ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


GCCcore/11.3.0:
   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   + ___________________________________ + + / This module will soon no
   longer \ + + \ be available on this cluster! / + +
   ----------------------------------- + + \ ^__^ + + \ (xx)\_______ + +
   (__)\ )\/\ + + U ||----w | + + || || + + + + Only modules installed with
   a recent toolchain will still be available + + when this cluster has been
   migrated to the RHEL 9 operating system. + + Recent toolchains include
   GCC(core)/12.3.0, gompi/2023a, foss/2023a, + + gfbf/2023a, iimpi/2023a,
   intel/2023a, and newer versions. + + + + You should update your workflow
   or job script to use more recent software installations, + + or accept
   that the modules you currently rely on will soon no longer be available.
   + + + + To request a more recent version of the software you are using, +
   + please submit a software installation request via: + +
   https://www.ugent.be/hpc/en/support/software-installation-request + + + +
   The HPC-UGent Tier-2 clusters running RHEL 8 will be migrated to RHEL 9.
   + + For more information, see https://docs.hpc.ugent.be/rhel9/ . + + + +
   If you have any questions, please contact hpc@ugent.be . + + + ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


foss/2022a:
   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   + ___________________________________ + + / This module will soon no
   longer \ + + \ be available on this cluster! / + +
   ----------------------------------- + + \ ^__^ + + \ (xx)\_______ + +
   (__)\ )\/\ + + U ||----w | + + || || + + + + Only modules installed with
   a recent toolchain will still be available + + when this cluster has been
   migrated to the RHEL 9 operating system. + + Recent toolchains include
   GCC(core)/12.3.0, gompi/2023a, foss/2023a, + + gfbf/2023a, iimpi/2023a,
   intel/2023a, and newer versions. + + + + You should update your workflow
   or job script to use more recent software installations, + + or accept
   that the modules you currently rely on will soon no longer be available.
   + + + + To request a more recent version of the software you are using, +
   + please submit a software installation request via: + +
   https://www.ugent.be/hpc/en/support/software-installation-request + + + +
   The HPC-UGent Tier-2 clusters running RHEL 8 will be migrated to RHEL 9.
   + + For more information, see https://docs.hpc.ugent.be/rhel9/ . + + + +
   If you have any questions, please contact hpc@ugent.be . + + + ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

-------------------------------------------------------------------------------

/apps/gent/RHEL8/zen2-ib/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages/paramiko/transport.py:236: CryptographyDeprecationWarning: Blowfish has been deprecated
  "class": algorithms.Blowfish,
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job                         count    min threads    max threads
------------------------  -------  -------------  -------------
all                             1              1              1
clustering                      8              1              1
dimensionality_reduction        1              1              1
total                          10              1              1

Select jobs to execute...

[Sat Dec  7 10:58:11 2024]
rule clustering:
    input: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz
    output: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.25_all/sample_metadata_after_clustering.txt.gz
    log: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust15_res0.25_batch_correction_None_all.log
    jobid: 10
    reason: Missing output files: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.25_all/sample_metadata_after_clustering.txt.gz
    wildcards: batch_variable=None, neigh_clust=15, res=0.25, incl_samples=all
    resources: tmpdir=/tmp, mem_mb=20000, mem_mib=19074

Warning message:
Vector for cluster reordering of wrong length 
Joining, by = "cluster"
[Sat Dec  7 11:01:50 2024]
Finished job 10.
1 of 10 steps (10%) done
Select jobs to execute...

[Sat Dec  7 11:01:50 2024]
rule clustering:
    input: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz
    output: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.15_all/sample_metadata_after_clustering.txt.gz
    log: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust15_res0.15_batch_correction_None_all.log
    jobid: 12
    reason: Missing output files: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.15_all/sample_metadata_after_clustering.txt.gz
    wildcards: batch_variable=None, neigh_clust=15, res=0.15, incl_samples=all
    resources: tmpdir=/tmp, mem_mb=20000, mem_mib=19074

Warning message:
Vector for cluster reordering of wrong length 
Joining, by = "cluster"
[Sat Dec  7 11:05:20 2024]
Finished job 12.
2 of 10 steps (20%) done
Select jobs to execute...

[Sat Dec  7 11:05:20 2024]
rule clustering:
    input: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz
    output: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust50_res0.25_all/sample_metadata_after_clustering.txt.gz
    log: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust50_res0.25_batch_correction_None_all.log
    jobid: 14
    reason: Missing output files: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust50_res0.25_all/sample_metadata_after_clustering.txt.gz
    wildcards: batch_variable=None, neigh_clust=50, res=0.25, incl_samples=all
    resources: tmpdir=/tmp, mem_mb=20000, mem_mib=19074

Warning message:
Vector for cluster reordering of wrong length 
Joining, by = "cluster"
[Sat Dec  7 11:09:24 2024]
Finished job 14.
3 of 10 steps (30%) done
Select jobs to execute...

[Sat Dec  7 11:09:24 2024]
rule clustering:
    input: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz
    output: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust50_res0.15_all/sample_metadata_after_clustering.txt.gz
    log: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust50_res0.15_batch_correction_None_all.log
    jobid: 16
    reason: Missing output files: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust50_res0.15_all/sample_metadata_after_clustering.txt.gz
    wildcards: batch_variable=None, neigh_clust=50, res=0.15, incl_samples=all
    resources: tmpdir=/tmp, mem_mb=20000, mem_mib=19074

Warning message:
Vector for cluster reordering of wrong length 
Joining, by = "cluster"
[Sat Dec  7 11:12:49 2024]
Finished job 16.
4 of 10 steps (40%) done
Select jobs to execute...

[Sat Dec  7 11:12:49 2024]
rule clustering:
    input: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz
    output: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.25_nodiff/sample_metadata_after_clustering.txt.gz
    log: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust15_res0.25_batch_correction_None_nodiff.log
    jobid: 9
    reason: Missing output files: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.25_nodiff/sample_metadata_after_clustering.txt.gz
    wildcards: batch_variable=None, neigh_clust=15, res=0.25, incl_samples=nodiff
    resources: tmpdir=/tmp, mem_mb=20000, mem_mib=19074

Error in .compute_mean_var(x, block = block, design = design, subset.row = s,  : 
  no residual d.f. in any level of 'block' for variance estimation
Calls: modelGeneVar ... .local -> .model_gene_var -> FUN -> .compute_mean_var
Execution halted
[Sat Dec  7 11:13:10 2024]
Error in rule clustering:
    jobid: 9
    input: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds, /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz
    output: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None/cluster_neighclust15_res0.25_nodiff/sample_metadata_after_clustering.txt.gz
    log: /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust15_res0.25_batch_correction_None_nodiff.log (check log file(s) for error details)
    shell:
        Rscript /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/scripts/clustering/clustering.R --incl_samples nodiff --sce /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/SingleCellExperiment.rds --metadata /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/doublet_detection/sample_metadata_after_doublets.txt.gz --reorder_clusters 1 2 3 4 5 6 --npcs 15 --samples C1 C2 C3 Early1 Early2 Early3 --features 2500 --n_neighbors_clusters 15 --resolution 0.25 --batch_variable None --n_neighbors 50 --min_dist 0.25 --colour_by sample nFeature_RNA nCount_RNA --outdir /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/dimensionality_reduction/batch_correction_None --clusterdir /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA/clustering/batch_correction_None > /kyukon/data/gent/courses/2024/design_project_C003698/groups/group01/RNA_logs/clustering_neighclust15_res0.25_batch_correction_None_nodiff.log
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2024-12-07T105804.894764.snakemake.log
